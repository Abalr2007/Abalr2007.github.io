<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Results</title>
	<style>
		
		.main{
			background-color: #e9e9e9;
            font-family: 'Arial', sans-serif;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
			padding: 50px;
		}


		
		.imessage {
			background-color: #fff;
			display: flex;
			flex-direction: column;
			font-family: "SanFrancisco";
			font-size: 1.3rem;
			margin: 0 auto 1rem;
			max-width: 600px;
			padding: 0.5rem 1.5rem;
		margin-top: 0px; }

		.imessage p {
		  border-radius: 1.15rem;
		  line-height: 1.25;
		  max-width: 75%;
		  padding: 0.5rem .875rem;
		  position: relative;
		  word-wrap: break-word;
		}

		.imessage p::before,
		.imessage p::after {
		  bottom: -0.1rem;
		  content: "";
		  height: 1rem;
		  position: absolute;
		}

		p.from-me {
		  align-self: flex-end;
		  background-color: #248bf5;
		  color: #fff; 
		}

		p.from-me::before {
		  border-bottom-left-radius: 0.8rem 0.7rem;
		  border-right: 1rem solid #248bf5;
		  right: -0.35rem;
		  transform: translate(0, -0.1rem);
		}

		p.from-me::after {
		  background-color: #fff;
		  border-bottom-left-radius: 0.5rem;
		  right: -40px;
		  transform:translate(-30px, -2px);
		  width: 10px;
		}

		p[class^="from-"] {
		  margin: 1rem 0;
		  width: fit-content;
		}

		p.from-me ~ p.from-me {
		  margin: 0.25rem 0 0;
		}

		p.from-me ~ p.from-me:not(:last-child) {
		  margin: 0.25rem 0 0;
		}

		p.from-me ~ p.from-me:last-child {
		  margin-bottom: 0.5rem;
		}

		p.from-them {
		  align-items: flex-start;
		  background-color: #e5e5ea;
		  color: #000;
		}

		p.from-them:before {
		  border-bottom-right-radius: 0.8rem 0.7rem;
		  border-left: 1rem solid #e5e5ea;
		  left: -0.35rem;
		  transform: translate(0, -0.1rem);
		}

		p.from-them::after {
		  background-color: #fff;
		  border-bottom-right-radius: 0.5rem;
		  left: 20px;
		  transform: translate(-30px, -2px);
		  width: 10px;
		}

		p[class^="from-"].emoji {
		  background: none;
		  font-size: 2.5rem;
		}

		p[class^="from-"].emoji::before {
		  content: none;
		}

		.no-tail::before {
		  display: none;
		}

		.margin-b_none {
		  margin-bottom: 0 !important;
		}

		.margin-b_one {
		  margin-bottom: 1rem !important;
		}

		.margin-t_one {
		  margin-top: 1rem !important;
		}
		  .imessage p {
			margin: 0.5rem 0;
		  }
		
		@font-face {
  font-family: "SanFrancisco";
  src:
    url("https://cdn.rawgit.com/AllThingsSmitty/fonts/25983b71/SanFrancisco/sanfranciscodisplay-regular-webfont.woff2") format("woff2"),
    url("https://cdn.rawgit.com/AllThingsSmitty/fonts/25983b71/SanFrancisco/sanfranciscodisplay-regular-webfont.woff") format("woff");
}

.iphone-msg-header {
    position: relative;
    padding: 8px 20px;
    background: #f5f5f5;
    border-bottom: 0.6px solid #d0d0d0;
}

.iphone-msg-header .iphone-msg-header-back {
    position: absolute;
    top: 64%;
	scale: 2;
    left: 0;
    transform: translate(0, -50%);
}
		.iphone-msg-header .modal-title {
    position: relative;
    width: 100%;
    display: block;
    text-align: center;
}
		.iphone-msg-header .modal-title .modal-title-img {
    position: relative;
    height: 75px;
    width: 75px;
    border-radius: 50%;
    overflow: hidden;
    margin: 0 auto;
    display: flex;
    justify-content: center;
    align-items: center;
    background: linear-gradient(to top, #878b94, #a4a8b4);
}
		.iphone-msg-header .modal-title .modal-title-img img {
    height: 75px;
    width: 58px;
    position: relative;
    left: 0px;
    top: 8px;
}
		.iphone-msg-header .modal-title .reciver-name {
    position: relative;
    margin-top: 16px;
    margin-left: 6px;
    color: #000000;
    font-weight: 400;
	font-size: 23px;
	font-family: "SanFrancisco";
    display: inline-block;
}
		img.fleche-call-icon {
    margin-top: -1px;
    margin-left: 0px;
			transform: translate(0, 2px);
}
		
		.headerimsg {
		  display: flex;
		  flex-direction: column;
		  font-family: "SanFrancisco";
		  font-size: 1.25rem;
		  margin: 0 auto 1rem;
		  max-width: 647px;
		  padding: 0.5rem 1.5rem;
		  padding-bottom: 0px;
			margin-bottom: 0px;
			position:sticky;
			top: 0;
			z-index: 1000;
		}
		
	
	</style>
</head>

<body style="background-color: #f0f8ff;">
	<h1 class= "main">Results of your Fake convo!</h1>
			<input id="ContactName" type="text" value="ContactName" oninput="updateText()">

	
		<div class="headerimsg">
	<div class="iphone-msg-header">
            	<div class="iphone-msg-header-back">
                	<img alt="iphone arrow" src="iphone-arrow.png" width="11px;" style="margin-left:15px;">
                </div>
                <div class="modal-title text-messenger-ios-title">
                     <div class="modal-title-img whatsapp-ios-img">
                         <img alt="user icon" src="https://prankshit.com/fr/assets/images/android-msg-user-icon.png">
                     </div>
                     <div class="reciver-name"><span class="text-name1" id="namej">Mirakle</span>
                     <img src="https://prankshit.com/fleche-call.png" alt="fleche call fake screenshot capture ecran" width="10" class="fleche-call-icon">
                     </div>
                     </div>
                    </div></div>
	<div class="imessage">
	</div>
	    <script>
        function updateText() {
            var inputText = document.getElementById("ContactName").value;
            document.getElementById("namej").innerText = inputText;
        }
    </script>
	
	<script>
        // Read the data from localStorage
        const jsonData = localStorage.getItem('formattedScriptData');
        if (jsonData) {
            const data = JSON.parse(jsonData);

            // Use the data to update the content of this HTML file
            const script = data.script;
            const speaker1Prefix = data.speaker1Prefix;
            const speaker2Prefix = data.speaker2Prefix;

            const lines = script.split('\n');
            const filteredLines = lines
                .map(line => line.trim()) // Remove leading/trailing whitespace
                .filter(line => line !== ''); // Filter out empty lines

            let formattedScript = '';
            let isReceiveConsecutive = false; // Track if we are in a consecutive sequence of receive elements
            let isSendConsecutive = false; // Track if we are in a consecutive sequence of send elements

            for (let i = 0; i < filteredLines.length; i++) {
                let line = filteredLines[i];
                if (line.startsWith(speaker1Prefix)) {
                    line = line.slice(speaker1Prefix.length).trim();

                    // Check if the next line is also a "receive" element
                    if (i < filteredLines.length - 1 && filteredLines[i + 1].startsWith(speaker1Prefix)) {
                        formattedScript += `<p class="from-me no-tail">${line}</p>`;
                        isReceiveConsecutive = true;
                    } else {
                        formattedScript += `<p class="from-me${isReceiveConsecutive ? ' ' : ''}">${line}</p>`;
                        isReceiveConsecutive = false;
						
						// Add an empty line at the end of the sequence
                        if (!isReceiveConsecutive) {
                            formattedScript += '<p class="filler" style="margin: 2px;"></p>';
                        }
                    }
                } else if (line.startsWith(speaker2Prefix)) {
                    line = line.slice(speaker2Prefix.length).trim();

                    // Check if the next line is also a "send" element
                    if (i < filteredLines.length - 1 && filteredLines[i + 1].startsWith(speaker2Prefix)) {
                        formattedScript += `<p class="from-them no-tail">${line}</p>`;
                        isSendConsecutive = true;
                    } else {
                        formattedScript += `<p class="from-them${isSendConsecutive ? ' ' : ''} ">${line}</p>`;
                        isSendConsecutive = false;

                        // Add an empty line at the end of the sequence
                        if (!isSendConsecutive) {
                            formattedScript += '<p class="filler" style="margin: 2px;"></p>';
                        }
                    }
                } else {
                    formattedScript += `<p>${line}</p>`;
                    isReceiveConsecutive = false;
                    isSendConsecutive = false;
                }
            }

            const formattedScriptContainer = document.querySelector(".imessage");
            formattedScriptContainer.innerHTML = formattedScript;
        }
    </script>

</body>
</html>
